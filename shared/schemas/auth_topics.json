{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://deskling.local/schemas/topics/auth.json",
  "title": "Authentication Topics",
  "description": "Schemas for auth.* topics",
  "definitions": {
    "auth_hello": {
      "type": "object",
      "required": ["service_name", "capabilities"],
      "properties": {
        "service_name": {
          "type": "string",
          "description": "Service identifier"
        },
        "capabilities": {
          "type": "array",
          "items": {"type": "string"},
          "description": "List of capabilities/topics this service handles"
        },
        "version": {
          "type": "string",
          "description": "Service version"
        }
      }
    },
    "auth_ok": {
      "type": "object",
      "required": ["session_token"],
      "properties": {
        "session_token": {
          "type": "string",
          "description": "Session authentication token"
        },
        "expires_at": {
          "type": "string",
          "format": "date-time",
          "description": "Token expiration timestamp"
        }
      }
    },
    "auth_error": {
      "type": "object",
      "required": ["code", "message"],
      "properties": {
        "code": {
          "type": "string",
          "enum": ["INVALID_SERVICE", "DUPLICATE_SERVICE", "AUTH_FAILED"]
        },
        "message": {
          "type": "string"
        }
      }
    }
  }
}
